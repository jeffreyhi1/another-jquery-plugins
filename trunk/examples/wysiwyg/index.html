<!DOCTYPE html>

<!-- $Id$ -->

<head>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/> 
<meta http-equiv="Pragma" content="no-cache"/>
<meta http-equiv="Expires" content="-1"/>

<link href="../../css/basics.css" rel="stylesheet" type="text/css"/>
<link href="../../css/960c12.css" rel="stylesheet" type="text/css"/>
<link href="../../css/style.css" rel="stylesheet" type="text/css"/>

<script type="text/javascript" charset="utf-8" src="../../jquery/1.6.2.js"></script> 

<title>wysiwyg - example</title>

<link href="../../source/css/release/jquery.ajp.css" rel="stylesheet" type="text/css"/>
<link href="../../source/css/release/theme/jquery.ajp.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" charset="utf-8" src="../../source/release/jquery.ajp.js"></script> 

<style>

body { margin: 1em; /*font-size: 16px;*/ }

#ex1 {
	background: #fff;
	border: 1px dashed #ccc;
	width: 660px;
	height: 200px;
	overflow: auto;
	padding: 6px;
	margin-bottom: 1em;
	position: relative;
	z-index: 1;
}

.toolbar {
	background: #eee;
	width: 672px;
	visibility: hidden;
	border: 1px solid #ddd;
}

.toolbar button, .toolbar .button {
	min-width: 3em;
	border: 0;
	float: left;
	margin: 0;
}

.toolbar button:active {
	background: #ccc;
}

.toolbar .bold { font-weight: bold; }
.toolbar .italic { font-style: italic; }
.toolbar .underline { text-decoration: underline; }
.toolbar .strike { text-decoration: line-through; }

.toolbar .button {
	padding: 0.07em 0.6em;
	min-width: 0;
}

.toolbar .delimiter {
	width: 1px;
	height: 1.8em;
	border-left: 1px solid #ddd;
	padding: 0;
	margin: 0;
	margin-top: 0.2em;
	float: left;
}

.foreground-colorpicker, .background-colorpicker {
	width: 2em;
	line-height: 2.2em;
}

.background-colorpicker {
	width: 3.6em;
}

.foreground-colorpicker > .letter {
	font-weight: bold;
	border-bottom: 2px solid red;
	margin-right: 0.4em;
}

.background-colorpicker > .letter {
	background-color: red;
	color: white;
	font-weight: bold;
	padding: 4px;
	margin-left: -4px;
	margin-right: 0.4em;
	position: relative;
	top: 0.2em;
}

.ajp-colorpicker {
	position: relative;
	z-index: 5;
	box-shadow: 0 3px 6px rgba(0,0,0,.1);
	border-top-width: 0;
	background: #fafafa;
	margin-top: 0.4em;
	margin-left: -0.8em;
}

.foreground-colorpicker span, .background-colorpicker span {
	position: relative;
	top: 0.2em;
}

.heading {
	width: 7em;
	line-height: 2.2em;
}

.heading span {
	position: relative;
	top: 0.2em;
}

.heading .label {
	margin-right: 0.4em;
}

.heading .popup {
	width: 200px;
	border: 1px solid #ddd;
	position: relative;
	z-index: 5;
	margin-top: 0.4em;
	margin-left: -0.8em;
	visibility: hidden;
	box-shadow: 0 3px 6px rgba(0,0,0,.1);
	border-top-width: 0;
}

.heading .popup .btn {
	display: block;
	background: #fafafa;
	float: none;
	text-align: left;
	padding-left: 0.75em;
}

.heading .popup .btn:hover {
	background: #eee;
}

button img {
	margin: 0;
	padding: 0;
	border: 0;
	outline: 0;
	position: relative;
	top: 0.2em;
}

.h1 { font-weight: bold; color: #000; }
.h2 { font-weight: bold; color: #333;  }
.h3 { font-weight: bold; color: #666; }
.h4 { font-weight: bold; text-shadow: none; color: #999; }
.h5 { text-shadow: none; color: #999; }
.h6 { text-shadow: none; color: #ccc; }

</style>

<script>

$(document).ready(function () {

	$('.toolbar .btn').each(function () {
		var $btn = $(this)
		var cmd = $btn.data('cmd')
		$btn.addClass(cmd).click(function () {
			var ctx = $('#ex1').ajp$editableContext()
			if ($btn.data('restore'))
				ctx.restoreSelection()
			ctx.execCommand(cmd)
		})
	})

	$(document).find('body:eq(0)').keydown(function (evt) {
		if (evt.keyCode == 27)
			$('.popup').css({ visibility: 'hidden' })
	})
	$(document).find('body:eq(0)').mouseup(function (evt) {
		if (evt.button == ($.browser.msie ? 1 : 0)) $('.popup').each(function () {
			var $c = $(this)
			var vis = $c.css('visibility')
			$c.data('toolbar-btn-heading-visible', (vis == 'hidden' ? 'no' : 'yes'))
			$c.css({ visibility: 'hidden' })
		})
	})

	$('.toolbar .heading').click(function () {

			var ctx = $('#ex1').ajp$editableContext()
			ctx.saveSelection()

		var $popup = $(this).find('.popup')
		var vis = ($popup.data('toolbar-btn-heading-visible') == 'yes' ? 'hidden' : 'visible')
		$popup.css({ visibility: vis })
	})

	$('.toolbar .foreground-colorpicker').ajp$colorpicker({
		onchange: function (val) {
			var ctx = $('#ex1').ajp$editableContext()
			ctx.replaceSelection('<span style="color: ' + val + '">' + ctx.getSelectedHtml() + '</span>')
		}
	})

	$('.toolbar .background-colorpicker').ajp$colorpicker({
		onchange: function (val) {
			var ctx = $('#ex1').ajp$editableContext()
			ctx.replaceSelection('<span style="background-color: ' + val + '">' + ctx.getSelectedHtml() + '</span>')
		}
	})

	$('.make-editable').click(function () {
		$('#ex1').css({ 'border-top-color': 'transparent' }).ajp$editable()
		$('.toolbar').css({ visibility: 'visible', opacity: 0 }).animate({ opacity: 1 }, 'fast', 'swing')
	})

	$('.make-uneditable').click(function () {
		$('#ex1').css({ 'border-top-color': '#ddd' }).ajp$uneditable()
		$('.toolbar').animate({ opacity: 0 }, 'fast', 'swing', function () { $(this).css({ visibility: 'visible', opacity: 0 }) })
	})

	$('.make-editable').click()
})

</script>

</head>

<body>

	<div class="toolbar">
		<button class="heading">
			<span class="label">Heading</span><span>&#x25BE;</span>
			<div class="popup">
				<div class="btn" data-cmd="h1" data-restore="true">Header 1</div>
				<div class="btn" data-cmd="h2" data-restore="true">Header 2</div>
				<div class="btn" data-cmd="h3" data-restore="true">Header 3</div>
				<div class="btn" data-cmd="h4" data-restore="true">Header 4</div>
				<div class="btn" data-cmd="h5" data-restore="true">Header 5</div>
				<div class="btn" data-cmd="h6" data-restore="true">Header 6</div>
			</div>
		</button>
		<div class="delimiter"></div>
		<button class="btn" data-cmd="bold">B</button>
		<button class="btn" data-cmd="italic">I</button>
		<button class="btn" data-cmd="underline">U</button>
		<button class="btn" data-cmd="strike">S</button>
		<div class="delimiter"></div>
		<button class="foreground-colorpicker"><span class="letter">A</span><span>&#x25BE;</span></button>
		<button class="background-colorpicker"><span class="letter">B</span><span>&#x25BE;</span></button>
		<div class="delimiter"></div>
		<button class="btn" data-cmd="anchor"><img src="link.png"/></button>
		<div class="delimiter"></div>
		<button class="btn" data-cmd="text"><img src="clear.png"/></button>

		<div class="clear"></div>
	</div>

	<div id="ex1">
		This is editable area. You can use Ctrl+b, Ctrl+i, Ctrl+u, Ctrl+s, Ctrl+r, Ctrl+l, Ctrl+[1-6] shortcuts.
	</div>

	<button class="make-editable">Make editable</button>
	<button class="make-uneditable">Make uneditable</button>

</body>